FROM node:iron-alpine@sha256:8e6a472eb9742f4f486ca9ef13321b7fc2e54f2f60814f339eeda2aff3037573

VOLUME ["/web/node_modules"]

VOLUME ["/web"]

WORKDIR /web

RUN apk add --no-cache --virtual .gyp \
        python \
        make \
        g++ \
        curl

CMD ["sh", "-c", "npm ci; npm run release; node dist/src/index.js"]
